{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'study/css/style.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 85vh;">

    <div class="w-100 fixed-top bg-white px-3 py-2 d-flex align-items-center shadow-sm" style="height: 60px; z-index: 100;">
        <a href="/" class="text-muted me-3"><i class="fas fa-times fa-lg"></i></a>
        <div class="progress flex-grow-1 rounded-pill" style="height: 8px; background-color: #eee;">
            <div class="progress-bar bg-warning rounded-pill" id="progress-bar" style="width: 0%"></div>
        </div>
        <div class="ms-3 text-warning"><i class="fas fa-lemon fa-lg"></i></div>
    </div>

    <div class="study-container w-100 px-3" style="max-width: 500px; margin-top: 50px;">

        <div id="screen-loading" class="text-center py-5">
            <div class="spinner-border text-warning" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2 text-muted">Đang tải câu hỏi...</p>
        </div>

        <div id="screen-finished" class="d-none text-center py-5 animate__animated animate__bounceIn">
            <i class="fas fa-trophy fa-4x text-warning mb-3"></i>
            <h3 class="fw-bold text-success">Hoàn thành ôn tập!</h3>
            <p class="text-muted">Bạn đã ôn hết các từ trong phiên này.</p>
            <div class="d-flex gap-3 mt-4 justify-content-center">
                <a href="/" class="btn btn-outline-secondary">
                    <i class="fas fa-home me-2"></i>Trang chủ
                </a>
                <button onclick="location.reload()" class="btn btn-primary">
                    <i class="fas fa-redo me-2"></i>Ôn lại
                </button>
            </div>
        </div>

        <div id="screen-question" class="d-none animate__animated animate__fadeIn">
            <div class="text-center card shadow-sm p-4 border-0">
                
                <h5 id="q-instruction" class="text-secondary mb-4 small text-uppercase fw-bold"></h5>

                <div id="q-audio-container" class="mb-4 d-none">
                    <button onclick="playAudio('q-audio-src')" class="btn btn-light rounded-circle p-4 shadow-sm">
                        <i class="fas fa-volume-up fa-2x text-warning"></i>
                    </button>
                    <audio id="q-audio-src"></audio>
                </div>

                <h4 id="q-content" class="fw-bold text-dark mb-4 d-none" style="letter-spacing: 2px;"></h4>

                <div id="q-options-container" class="d-flex flex-column gap-3 mb-4 d-none">
                    </div>

                <input type="text" id="user-input" 
                       class="form-control form-control-lg text-center fw-bold border-2 rounded-pill py-3 mb-4 d-none" 
                       placeholder="Gõ từ vựng..." autocomplete="off">

                <button onclick="submitAnswer()" class="btn btn-mochi w-100 rounded-pill py-3 shadow-sm" id="btn-check" disabled>
                    Kiểm tra
                </button>

                <a href="#" onclick="skipQuestion(); return false;" class="text-muted mt-3 small d-block">
                    Mình không nhớ từ này
                </a>
            </div>
        </div>

        <div id="screen-correct" class="d-none text-center p-5 animate__animated animate__bounceIn">
            <i class="fas fa-check-circle text-success" style="font-size: 80px;"></i>
            <h2 class="fw-bold text-success mt-4">CHÍNH XÁC!</h2>
            
            <h4 id="res-correct-word" class="text-primary mt-3"></h4>
            <p id="res-correct-phonetic" class="text-muted fst-italic"></p>
            <p id="res-correct-def" class="text-dark"></p>

            <button onclick="loadNextQuestion()" class="btn btn-success w-100 rounded-pill py-3 fw-bold mt-3">TIẾP TỤC</button>
        </div>

        <div id="screen-wrong" class="d-none p-4 text-center animate__animated animate__shakeX card shadow-sm border-danger">
            <div class="alert alert-danger rounded-pill fw-bold mb-4">CHƯA CHÍNH XÁC</div>
            
            <h6 class="text-muted small text-uppercase">Đáp án đúng là:</h6>
            <h2 id="res-wrong-word" class="fw-bold text-primary"></h2>
            <p id="res-wrong-phonetic" class="text-muted fst-italic"></p>
            <p id="res-wrong-def" class="text-dark"></p>
            
            <button onclick="loadNextQuestion()" class="btn btn-secondary w-100 rounded-pill py-3 fw-bold mt-3">TIẾP TỤC</button>
        </div>

    </div>
</div>

<script src="{% static 'study/js/notebook_review.js' %}"></script>
{% endblock %}